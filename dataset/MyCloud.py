# -*- coding: utf-8 -*-
"""Untitled1.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1EOB4SemN_IdlrBtvGjCEwnOr06aLRiG0
"""

!pip install  pymysql jqdatasdk

import pymysql
import jqdatasdk

'''
conn = pymysql.connect(host="cdb-mqzvz536.bj.tencentcdb.com",port =10146,user="visitor",password="visitor")
cursor=conn.cursor()
cursor.execute("use stock_data;")
cursor.execute("create table if not exists stock_test (idx int, value float)")
cursor.execute("show tables;")
print(cursor.fetchall())
cursor.execute("show tables like 'stock_test'")
print(cursor.fetchall())
cursor.execute("show tables like 'play_test'")
print(cursor.fetchall())
'''

class my_data:
  def __init__(self):
    """create a class for tencent mysql cloud"""
    self.conn = None
    self.cursor =None 
    pass
  
  def __del__(self):
    self.conn.close()

  def init(self,host="cdb-mqzvz536.bj.tencentcdb.com",port=10146,user='visitor',password='visitor'):
    self.conn = pymysql.connect(host=host,port =port,user=user,password=password)
    self.cursor=self.conn.cursor()
    self.cursor.execute("use stock_data;")
  
  def has_table(self,table_name):
    self.cursor.execute("show tables like '{}'".format(table_name))
    return len(self.cursor.fetchall())

  def create_table(self,table_name,structs):
    self.cursor.execute("create table {} ({})".format(table_name,structs))
  
  def exec(self,command):
    if(type(command)==list):
      self.cursor.executemany(command)
    else:
      self.cursor.execute(command)
    return self.cursor.fetchall()

